/*!
 *
 *** Copyright (c) 2023 Patrick Khoo @ https://deepwave.net ***
 *
 */
var e,t,n,o,a,s,c,r,l,d,i,u,m,p,k,v=null,f=null,y=0,g=[],h=0,w=null,x=50,L=1e3/x,E=null,I='Roll Camera <span class="txt-tiny">[Q]</span>',M='Stop Camera <span class="txt-tiny">[Q]</span>',T='Action! <span class="txt-tiny">[M]</span>',B='Good Take <span class="txt-tiny">[M]</span>',b='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>',D='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check"><polyline points="20 6 9 17 4 12"/></svg>';function H(){e.innerHTML=z(),t.innerHTML=z(f)}function _(){null===v?(clearInterval(w),w=setInterval(H,L),null===E&&(E=J()),y++,h=0,g[y-1]=0,v=new Date,H(),e.classList.add("txt-contrast"),a.innerHTML=M,a.classList.add("contrast"),s.disabled=!1,d.disabled=!0):(clearInterval(w),A(!0),H(),1>g[y-1]?(y--,g.pop()):S(),v=null,f=null,e.classList.remove("txt-contrast"),a.innerHTML=I,a.classList.remove("contrast"),s.disabled=!0,d.disabled=!1)}function S(){n.innerHTML+="<tr><td class='txt-right' colspan='2'>Total Recording / Take Duration:</td><td class='txt-center'>"+e.innerHTML+"</td><td class='txt-center'>"+z(0,h)+"</td><td colspan='2'><span></span></td></tr>"}function C(){null!==v&&(null===f?(f=new Date,t.classList.add("txt-contrast"),s.innerHTML=B,s.classList.add("contrast"),c.classList.add("secondary"),c.disabled=!1,P()):A(!0))}function A(e=!1){null!==f&&(e&&(now=new Date,h+=now-f,g[y-1]++,takeno=g[y-1],n.innerHTML+="<tr id='take-"+y+"-"+takeno+"'><td class='txt-center'>"+y+"</td><td class='txt-center'>"+takeno+"</td><td class='txt-center'>"+z(v,f)+"</td><td class='txt-center'>"+z(v,now)+"</td><td class='txt-center'>"+z(f,now)+"</td><td><span id='take-cmt-"+y+"-"+takeno+"'></span></td></tr>"),f=null,t.classList.remove("txt-contrast"),s.innerHTML=T,s.classList.remove("contrast"),c.classList.remove("secondary"),c.disabled=!0,P())}function Q(){return!!r.open}function j(){Q()||(r.open=!0),m.focus()}function N(){O(),Q()&&(r.open=!1)}function R(){var e="";null!==E?(e="Session Start: "+E+"\n",end_str="Session End:   "+J()+"\n\n"):(e="Session Start: N/A\n",end_str="Session End:   N/A\n\n"),navigator.clipboard.writeText(e+end_str+o.innerText+"\n").then((()=>{l.innerHTML=D,setTimeout((function(){l.innerHTML=b}),5e3)}),(()=>{}))}function q(){p.focus(),recno=parseInt(u.value)||0,(recno<1||recno>g.length)&&(recno=y),takeno=parseInt(m.value)||0,takeno<1||takeno>g[recno-1]||(cur_comment=document.getElementById("take-cmt-"+recno+"-"+takeno).innerText,cur_comment.length>0&&(p.value=cur_comment))}function G(){recno=parseInt(u.value)||0,(recno<1||recno>g.length)&&(recno=y),takeno=parseInt(m.value)||0,takeno<1||takeno>g[recno-1]||(document.getElementById("take-cmt-"+recno+"-"+takeno).innerText=p.value,K(),m.focus())}function K(){m.value="",p.value=""}function V(){L=2>x?1e3:1e3/x,H()}function X(){i.open?i.open=!1:i.open=!0}function z(e=v,t=new Date){return null===e||null===t?2>x?"00:00:00":99<x?"00:00:00:000":"00:00:00:00":(elapsed=t-e,hours=Math.floor(elapsed/36e5),elapsed%=36e5,minutes=Math.floor(elapsed/6e4),elapsed%=6e4,seconds=Math.floor(elapsed/1e3),cur_str=F(hours)+":"+F(minutes)+":"+F(seconds),2>x?cur_str:(miliseconds=elapsed%1e3,frames=Math.floor(miliseconds/L),99<x?cur_str+":"+F(frames,3):cur_str+":"+F(frames)))}function F(e,t=2){var n="000000000"+e;return t<10?n.substring(n.length-t):n}function J(){var e=new Date,t=e.getHours(),n=t>=12?"pm":"am";return(t=(t%=12)||12)+":"+F(e.getMinutes())+":"+F(e.getSeconds())+" "+n+", "+e.toDateString()}function O(){document.activeElement&&document.activeElement.blur()}function P(){k.play()}window.onload=function(){e=document.getElementById("disp-main"),t=document.getElementById("disp-take"),n=document.getElementById("disp-takes"),o=document.getElementById("disp-take-log"),a=document.getElementById("btn-camera"),s=document.getElementById("btn-take"),c=document.getElementById("btn-discard"),r=document.getElementById("btn-takes"),l=document.getElementById("btn-copy"),d=document.getElementById("btn-fps"),i=document.getElementById("btn-help"),u=document.getElementById("rec-no"),m=document.getElementById("take-no"),p=document.getElementById("take-comment"),k=document.getElementById("beep-audio"),a.innerHTML=I,s.innerHTML=T,a.onclick=function(){_()},s.onclick=function(){C()},c.onclick=function(){A()},l.onclick=function(){R()},d.onchange=function(){x=d.value,V()},document.addEventListener("keydown",(function(e){return Q()&&"Escape"==e.key?(e.preventDefault(),void N()):"take-comment"==e.target.id?"Enter"==e.key?(e.preventDefault(),void G()):void 0:"take-no"!=e.target.id||"Enter"!=e.key&&"Tab"!=e.key?"Q"==e.key||"q"==e.key?(e.preventDefault(),void _()):"M"==e.key||"m"==e.key?(e.preventDefault(),void C()):"X"==e.key||"x"==e.key?(e.preventDefault(),void A()):"L"==e.key||"l"==e.key?(e.preventDefault(),void j()):"H"==e.key||"h"==e.key?(e.preventDefault(),void X()):!e.ctrlKey||"C"!=e.key&&"c"!=e.key?void 0:(e.preventDefault(),void R()):(e.preventDefault(),void q())})),V(),H(),l.innerHTML=b};